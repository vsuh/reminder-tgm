#!/usr/bin/env sh

remote="$1"
url="$2"

to_push=$(git rev-list --count @{u}..HEAD 2>/dev/null)
if [ "$to_push" = "0" ] 2>/dev/null || [ -z "$to_push" ]; then
  exit 0
fi

local_tag=$(git describe --tags --abbrev=0 2>/dev/null)
remote_tag=$(git ls-remote --tags "$remote" | awk -F/ '{print $3}' | sort -V | tail -n1)

# –ï—Å–ª–∏ —Ç–µ–≥–æ–≤ –Ω–µ—Ç ‚Äî –≤—ã—Ö–æ–¥–∏–º
[ -z "$local_tag" ] && exit 0
[ -z "$remote_tag" ] && exit 0

# –ï—Å–ª–∏ —Ç–µ–≥ –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Äî –≤—ã—Ö–æ–¥–∏–º
[ "$local_tag" = "$remote_tag" ] && exit 0

echo "############################################################"
echo "üöÄ  –¢–µ–≥ –∏–∑–º–µ–Ω–∏–ª—Å—è $remote_tag ‚Üí $local_tag"
echo "    –ù–∞ github.com –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è workflow –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞."
echo "    –ß–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –ø—Ä–∏–¥–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram."
echo "############################################################"

exit 0
